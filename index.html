<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle de Finan√ßas Pessoais</title>
  <meta name="google" content="notranslate">
:root {
  /* Paleta oficial */
  --ivory: #FFF9E2;
  --peach: #FEFCD0;
  --pistachio: #EBECCC;
  --eucalyptus: #CDD4B1;
  --clay: #DCA278;
  }

  /* Vari√°veis usadas no layout */
  --bg: var(--ivory);
  --card-bg: var(--peach);
  --accent: var(--eucalyptus);
  --accent-soft: var(--pistachio);
  --danger: var(--clay);
  --text-main: #3F3F3F;
  --text-muted: #7A7A7A;
  --border: #D9D9D9;
  --radius: 12px;
  --shadow: 0 10px 25px rgba(0, 0, 0, 0.06);
}

  /* Vari√°veis extras usadas no background */
  --eucalyptus: #CDD4B1;
  --pistachio: #EBECCC;
  --ivory: #FFF9E2;
}

      /* Usando a paleta no layout */
      --bg: var(--pistachio);
      --card-bg: var(--ivory);
      --accent: var(--clay);
      --accent-soft: var(--peach);
      --danger: #b5473a; /* um vermelho terroso para alertas */
      --text-main: #3f3a2c;
      --text-muted: #7a6f5d;
      --border: #d9d0c0;
      --radius: 12px;
      --shadow: 0 10px 25px rgba(0, 0, 0, 0.06);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      padding: 16px;
      display: flex;
      justify-content: center;
      background:
        radial-gradient(circle at top, var(--eucalyptus) 0, var(--pistachio) 40%, var(--ivory) 100%);
      color: var(--text-main);
    }

    .app {
      width: 100%;
      max-width: 960px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(16px);
      border-radius: 20px;
      box-shadow: var(--shadow);
      padding: 20px 18px 28px;
      border: 1px solid var(--border);
    }

    header {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 20px;
    }

    header h1 {
      font-size: 1.6rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    header h1 span.icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: var(--accent-soft);
      font-size: 18px;
    }

    header p {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .summary-cards {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 18px;
    }

    .card {
   .card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  padding: 15px;
}
    }

    .card span.label {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .card strong {
      font-size: 1rem;
    }

    .card.saldo {
      background: linear-gradient(135deg, var(--clay), #c36d3c);
      color: #ffffff;
      border: none;
    }

    .saldo.negative {
      background: linear-gradient(135deg, #b5473a, #8a1f1f);
    }

    .saldo span.label {
      color: #f7ead9;
    }

    .form-card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 14px 12px;
      border: 1px solid var(--border);
      margin-bottom: 16px;
    }

    .form-card h2 {
      font-size: 1rem;
      margin-bottom: 10px;
    }

    form {
      display: grid;
      gap: 10px;
    }

    .form-row {
      display: grid;
      gap: 8px;
    }

    @media (min-width: 640px) {
      .form-row.double {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      .form-row.triple {
        grid-template-columns: 1.2fr 1fr 1fr;
      }
    }

    label {
      font-size: 0.8rem;
      color: var(--text-muted);
      display: block;
      margin-bottom: 3px;
    }

    input, select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-size: 0.9rem;
      outline: none;
      background: #faf7ef;
    }

    input:focus, select:focus {
      border-color: var(--accent);
      background: #fffdf8;
    }

    .tipo-options {
      display: flex;
      gap: 8px;
      font-size: 0.85rem;
    }

    .tipo-options label {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      cursor: pointer;
      margin-bottom: 0;
      background: #faf7ef;
    }

    .tipo-options input {
      width: auto;
      padding: 0;
    }

    .btn-primary {
      border: none;
      border-radius: 999px;
      padding: 9px 12px;
      font-size: 0.9rem;
      font-weight: 600;
      background: var(--accent);
      color: #ffffff;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .btn-primary:active {
      transform: translateY(1px);
    }

    .btn-secondary {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #faf7ef;
      padding: 8px 10px;
      font-size: 0.8rem;
      cursor: pointer;
      color: var(--text-main);
    }

    .btn-danger {
      border-radius: 999px;
      border: 1px solid #f2c2ba;
      background: #fbe8e5;
      color: #b5473a;
      padding: 5px 8px;
      font-size: 0.75rem;
      cursor: pointer;
    }

    .actions-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
      margin-top: 4px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .filters-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .filters select {
      width: auto;
    }

    .table-card {
      background: var(--card-bg);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 10px 12px;
      max-height: 380px;
      overflow: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    thead {
      position: sticky;
      top: 0;
      background: var(--peach);
      z-index: 1;
    }

    th, td {
      padding: 6px 4px;
      text-align: left;
      border-bottom: 1px solid #efe4d4;
      white-space: nowrap;
    }

    th {
      font-weight: 600;
      color: var(--text-muted);
      font-size: 0.78rem;
    }

    td.valor-entrada {
      color: #2f6f45;
    }

    td.valor-saida {
      color: #b5473a;
    }

    .empty-state {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-align: center;
      padding: 12px 0;
    }

    .badge {
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 0.7rem;
      border: 1px solid #e5d6c4;
      display: inline-block;
      background: #faf4ea;
    }

    .badge.entrada {
      border-color: #cbe5c5;
      background: #f1faed;
      color: #2f6f45;
    }

    .badge.saida {
      border-color: #f2c2ba;
      background: #fbe8e5;
      color: #b5473a;
    }

    .small-text {
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    footer {
      margin-top: 10px;
      text-align: center;
      font-size: 0.7rem;
      color: var(--text-muted);
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>
        <span class="icon">üåø</span>
        Controle de Finan√ßas Pessoais
      </h1>
      <p>Registre entradas e sa√≠das, veja o saldo e acompanhe m√™s a m√™s.</p>
    </header>

    <section class="summary-cards">
      <div class="card">
        <span class="label">Entradas</span>
        <strong id="totalEntradas">‚Ç¨ 0,00</strong>
        <span class="small-text">Tudo o que entrou</span>
      </div>
      <div class="card">
        <span class="label">Sa√≠das</span>
        <strong id="totalSaidas">‚Ç¨ 0,00</strong>
        <span class="small-text">Tudo o que saiu</span>
      </div>
      <div class="card saldo" id="cardSaldo">
        <span class="label">Saldo</span>
        <strong id="saldoAtual">‚Ç¨ 0,00</strong>
        <span class="small-text" id="saldoMensagem">Voc√™ est√° em dia üôÇ</span>
      </div>
    </section>

    <section class="form-card">
      <h2>Adicionar movimenta√ß√£o</h2>
      <form id="formTransacao">
        <div class="form-row">
          <div>
            <label for="descricao">Descri√ß√£o</label>
            <input type="text" id="descricao" placeholder="Ex: Sal√°rio, Mercado, Aluguel" required>
          </div>
        </div>

        <div class="form-row triple">
          <div>
            <label>Tipo</label>
            <div class="tipo-options">
              <label>
                <input type="radio" name="tipo" value="entrada" checked>
                Entrada
              </label>
              <label>
                <input type="radio" name="tipo" value="saida">
                Sa√≠da
              </label>
            </div>
          </div>

          <div>
            <label for="categoria">Categoria</label>
            <select id="categoria">
              <option value="Outros">Outros</option>
              <option value="Sal√°rio">Sal√°rio</option>
              <option value="Mercado">Mercado</option>
              <option value="Moradia">Moradia</option>
              <option value="Transporte">Transporte</option>
              <option value="Lazer">Lazer</option>
              <option value="Sa√∫de">Sa√∫de</option>
              <option value="Estudos">Estudos</option>
            </select>
          </div>

          <div>
            <label for="data">Data</label>
            <input type="date" id="data">
          </div>
        </div>

        <div class="form-row double">
          <div>
            <label for="valor">Valor (‚Ç¨)</label>
            <input type="number" id="valor" step="0.01" min="0" placeholder="0,00" required>
          </div>
          <div class="actions-row">
            <button type="submit" class="btn-primary">
              + Adicionar
            </button>
          </div>
        </div>
        <p class="small-text">Os dados ficam salvos apenas neste dispositivo (localStorage).</p>
      </form>
    </section>

    <section class="filters">
      <div class="filters-group">
        <span class="small-text">Filtrar por m√™s:</span>
        <select id="filtroMes">
          <option value="">Todos os meses</option>
          <option value="0">Janeiro</option>
          <option value="1">Fevereiro</option>
          <option value="2">Mar√ßo</option>
          <option value="3">Abril</option>
          <option value="4">Maio</option>
          <option value="5">Junho</option>
          <option value="6">Julho</option>
          <option value="7">Agosto</option>
          <option value="8">Setembro</option>
          <option value="9">Outubro</option>
          <option value="10">Novembro</option>
          <option value="11">Dezembro</option>
        </select>

        <select id="filtroAno">
          <option value="">Todos os anos</option>
        </select>
      </div>

      <div class="filters-group">
        <button type="button" class="btn-secondary" id="btnExportar">Exportar CSV</button>
        <button type="button" class="btn-secondary" id="btnCompartilhar">Compartilhar resumo</button>
        <button type="button" class="btn-danger" id="btnLimpar">Apagar tudo</button>
      </div>
    </section>

    <section class="table-card">
      <table>
        <thead>
          <tr>
            <th>Data</th>
            <th>Descri√ß√£o</th>
            <th>Categoria</th>
            <th>Tipo</th>
            <th>Valor</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="tabelaTransacoes">
          <tr>
            <td colspan="6" class="empty-state">Nenhuma movimenta√ß√£o cadastrada ainda.</td>
          </tr>
        </tbody>
      </table>
    </section>

    <footer>
      Feito com carinho por Priscila üíõ | Dados apenas neste aparelho.
    </footer>
  </div>

  <script>
    const STORAGE_KEY = "financasPessoaisTransacoes";
    let transacoes = [];

    const form = document.getElementById("formTransacao");
    const descricaoInput = document.getElementById("descricao");
    const valorInput = document.getElementById("valor");
    const dataInput = document.getElementById("data");
    const categoriaSelect = document.getElementById("categoria");
    const filtroMes = document.getElementById("filtroMes");
    const filtroAno = document.getElementById("filtroAno");
    const tabelaTransacoes = document.getElementById("tabelaTransacoes");

    const totalEntradasEl = document.getElementById("totalEntradas");
    const totalSaidasEl = document.getElementById("totalSaidas");
    const saldoAtualEl = document.getElementById("saldoAtual");
    const saldoMensagemEl = document.getElementById("saldoMensagem");
    const cardSaldoEl = document.getElementById("cardSaldo");

    const btnExportar = document.getElementById("btnExportar");
    const btnCompartilhar = document.getElementById("btnCompartilhar");
    const btnLimpar = document.getElementById("btnLimpar");

    function formatarMoeda(valor) {
      return valor.toLocaleString("pt-BR", {
        style: "currency",
        currency: "EUR"
      });
    }

    function salvarNoStorage() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(transacoes));
    }

    function carregarDoStorage() {
      const dados = localStorage.getItem(STORAGE_KEY);
      if (dados) {
        try {
          transacoes = JSON.parse(dados);
        } catch (e) {
          transacoes = [];
        }
      }
    }

    function obterTipoSelecionado() {
      const radios = document.querySelectorAll("input[name='tipo']");
      for (const r of radios) {
        if (r.checked) return r.value;
      }
      return "entrada";
    }

    function adicionarTransacao(event) {
      event.preventDefault();

      const descricao = descricaoInput.value.trim();
      const valorBruto = valorInput.value;
      const tipo = obterTipoSelecionado();
      const categoria = categoriaSelect.value;
      const dataStr = dataInput.value || new Date().toISOString().substring(0, 10);

      if (!descricao || !valorBruto) {
        alert("Preencha descri√ß√£o e valor.");
        return;
      }

      const valor = parseFloat(valorBruto.replace(",", "."));
      if (isNaN(valor) || valor <= 0) {
        alert("Informe um valor maior que zero.");
        return;
      }

      const transacao = {
        id: Date.now(),
        descricao,
        tipo,
        categoria,
        valor,
        data: dataStr
      };

      transacoes.push(transacao);
      salvarNoStorage();
      atualizarFiltrosAno();
      atualizarTela();

      form.reset();
      dataInput.value = dataStr;
    }

    function filtrarTransacoes() {
      const mes = filtroMes.value;
      const ano = filtroAno.value;

      return transacoes.filter(t => {
        const d = new Date(t.data + "T00:00:00");
        const tMes = d.getMonth().toString();
        const tAno = d.getFullYear().toString();

        const mesOk = mes === "" || mes === tMes;
        const anoOk = ano === "" || ano === tAno;

        return mesOk && anoOk;
      });
    }

    function atualizarResumo() {
      const lista = filtrarTransacoes();
      let entradas = 0;
      let saidas = 0;

      lista.forEach(t => {
        if (t.tipo === "entrada") {
          entradas += t.valor;
        } else {
          saidas += t.valor;
        }
      });

      const saldo = entradas - saidas;

      totalEntradasEl.textContent = formatarMoeda(entradas);
      totalSaidasEl.textContent = formatarMoeda(saidas);
      saldoAtualEl.textContent = formatarMoeda(saldo);

      cardSaldoEl.classList.remove("negative");

      if (saldo < 0) {
        cardSaldoEl.classList.add("negative");
        saldoMensagemEl.textContent = "Cuidado: saldo negativo.";
      } else if (saldo === 0 && (entradas > 0 || saidas > 0)) {
        saldoMensagemEl.textContent = "Voc√™ est√° no zero. Que tal guardar um pouco?";
      } else if (saldo > 0 && saidas === 0) {
        saldoMensagemEl.textContent = "Come√ßo perfeito! Comece a registrar seus gastos.";
      } else if (saldo > 0) {
        saldoMensagemEl.textContent = "Parab√©ns, voc√™ est√° no positivo! üéâ";
      } else {
        saldoMensagemEl.textContent = "Voc√™ est√° em dia üôÇ";
      }
    }

    function atualizarTabela() {
      const lista = filtrarTransacoes();

      tabelaTransacoes.innerHTML = "";

      if (lista.length === 0) {
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        td.colSpan = 6;
        td.className = "empty-state";
        td.textContent = "Nenhuma movimenta√ß√£o encontrada para este filtro.";
        tr.appendChild(td);
        tabelaTransacoes.appendChild(tr);
        return;
      }

      lista
        .sort((a, b) => (a.data < b.data ? 1 : -1))
        .forEach(t => {
          const tr = document.createElement("tr");

          const dataTd = document.createElement("td");
          const d = new Date(t.data + "T00:00:00");
          dataTd.textContent = d.toLocaleDateString("pt-BR");

          const descTd = document.createElement("td");
          descTd.textContent = t.descricao;

          const catTd = document.createElement("td");
          catTd.textContent = t.categoria;

          const tipoTd = document.createElement("td");
          const badge = document.createElement("span");
          badge.className = "badge " + (t.tipo === "entrada" ? "entrada" : "saida");
          badge.textContent = t.tipo === "entrada" ? "Entrada" : "Sa√≠da";
          tipoTd.appendChild(badge);

          const valorTd = document.createElement("td");
          valorTd.textContent = formatarMoeda(t.valor);
          valorTd.className = t.tipo === "entrada" ? "valor-entrada" : "valor-saida";

          const acaoTd = document.createElement("td");
          const btn = document.createElement("button");
          btn.className = "btn-danger";
          btn.textContent = "Excluir";
          btn.onclick = () => excluirTransacao(t.id);
          acaoTd.appendChild(btn);

          tr.appendChild(dataTd);
          tr.appendChild(descTd);
          tr.appendChild(catTd);
          tr.appendChild(tipoTd);
          tr.appendChild(valorTd);
          tr.appendChild(acaoTd);

          tabelaTransacoes.appendChild(tr);
        });
    }

    function excluirTransacao(id) {
      if (!confirm("Deseja mesmo excluir esta movimenta√ß√£o?")) return;
      transacoes = transacoes.filter(t => t.id !== id);
      salvarNoStorage();
      atualizarFiltrosAno();
      atualizarTela();
    }

    function atualizarFiltrosAno() {
      const anos = Array.from(
        new Set(
          transacoes.map(t => new Date(t.data + "T00:00:00").getFullYear())
        )
      ).sort();

      const valorSelecionado = filtroAno.value;
      filtroAno.innerHTML = '<option value="">Todos os anos</option>';

      anos.forEach(ano => {
        const opt = document.createElement("option");
        opt.value = ano.toString();
        opt.textContent = ano.toString();
        filtroAno.appendChild(opt);
      });

      if (valorSelecionado) {
        filtroAno.value = valorSelecionado;
      }
    }

    function exportarCSV() {
      if (!transacoes.length) {
        alert("N√£o h√° dados para exportar.");
        return;
      }

      const lista = filtrarTransacoes();
      if (!lista.length) {
        alert("N√£o h√° dados neste filtro para exportar.");
        return;
      }

      const cabecalho = ["Data", "Descri√ß√£o", "Categoria", "Tipo", "Valor (‚Ç¨)"];
      const linhas = lista.map(t => {
        const d = new Date(t.data + "T00:00:00").toLocaleDateString("pt-BR");
        return [
          d,
          t.descricao.replace(/;/g, ","),
          t.categoria,
          t.tipo,
          t.valor.toFixed(2).replace(".", ",")
        ].join(";");
      });

      const csv = [cabecalho.join(";"), ...linhas].join("\n");
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "financas-pessoais.csv";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    async function compartilharResumo() {
      const lista = filtrarTransacoes();
      let entradas = 0;
      let saidas = 0;

      lista.forEach(t => {
        if (t.tipo === "entrada") entradas += t.valor;
        else saidas += t.valor;
      });

      const saldo = entradas - saidas;
      const texto =
        "Resumo das minhas finan√ßas:\n" +
        "Entradas: " + formatarMoeda(entradas) + "\n" +
        "Sa√≠das: " + formatarMoeda(saidas) + "\n" +
        "Saldo: " + formatarMoeda(saldo) + "\n\n" +
        "Controle criado com meu app de Finan√ßas Pessoais. üíõ";

      if (navigator.share) {
        try {
          await navigator.share({ text: texto });
        } catch (e) {
          // cancelado
        }
      } else {
        navigator.clipboard.writeText(texto).then(() => {
          alert("Resumo copiado para a √°rea de transfer√™ncia!");
        }).catch(() => {
          alert("N√£o foi poss√≠vel compartilhar automaticamente.");
        });
      }
    }

    function limparTudo() {
      if (!transacoes.length) {
        alert("N√£o h√° dados para apagar.");
        return;
      }
      if (!confirm("Tem certeza que deseja apagar todas as movimenta√ß√µes deste aparelho?")) return;
      transacoes = [];
      salvarNoStorage();
      atualizarFiltrosAno();
      atualizarTela();
    }

    function atualizarTela() {
      atualizarResumo();
      atualizarTabela();
    }

    function inicializar() {
      carregarDoStorage();
      atualizarFiltrosAno();
      atualizarTela();

      if (!dataInput.value) {
        dataInput.value = new Date().toISOString().substring(0, 10);
      }

      form.addEventListener("submit", adicionarTransacao);
      filtroMes.addEventListener("change", atualizarTela);
      filtroAno.addEventListener("change", atualizarTela);
      btnExportar.addEventListener("click", exportarCSV);
      btnCompartilhar.addEventListener("click", compartilharResumo);
      btnLimpar.addEventListener("click", limparTudo);
    }

    document.addEventListener("DOMContentLoaded", inicializar);
  </script>
</body>
</html>
